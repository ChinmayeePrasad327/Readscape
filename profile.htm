<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>User Profile - READSCAPE</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.4/dist/css/bootstrap.min.css" rel="stylesheet" />
    <!-- Font Awesome CDN -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="stylesheet" href="books.css" />
  <style>
    body {
      padding-top: 80px;
    }
    .profile-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 30px;
    }
    .profile-box {
      flex: 1 1 300px;
      max-width: 350px;
      padding: 25px;
      border-radius: 15px;
      background: #fff8f0;
      box-shadow: 0 0 12px rgba(0, 0, 0, 0.1);
    }
    .content-box {
      flex: 2 1 500px;
      max-width: 700px;
      padding: 25px;
      border-radius: 15px;
      background: #fdf4e3;
      box-shadow: 0 0 12px rgba(0, 0, 0, 0.05);
    }
    .profile-img {
      width: 120px;
      height: 120px;
      object-fit: cover;
      border-radius: 50%;
      border: 2px solid #ccc;
    }
    .edit-section {
      display: none;
    }
    .dark-mode .profile-box,
    .dark-mode .content-box {
      background-color: #1e1e1e;
      color: #f1f1f1;
    }
    .dark-mode input,
    .dark-mode textarea {
      background-color: #2a2a2a;
      color: #f1f1f1;
      border: 1px solid #555;
    }
  </style>
</head>
<body>
<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-brown px-3" style="position: fixed; top: 0; left: 0; width: 100%; z-index: 9999;">
  <a class="navbar-brand text-white fw-bold" href="#">ReadEscape</a>
  <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavbar">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="mainNavbar">
    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
      <li class="nav-item"><a class="nav-link text-white" href="Book.htm">Home</a></li>
      <li class="nav-item"><a class="nav-link text-white" href="#">About Us</a></li>
      <li class="nav-item"><a class="nav-link text-white" href="#">Books</a></li>
      <li class="nav-item"><a class="nav-link text-white" href="#">Ebooks</a></li>
      <li class="nav-item"><a class="nav-link text-white" href="AudioBook.htm">Audio Books</a></li>
      <li class="nav-item"><a class="nav-link text-white" href="Text.htm">Text Books</a></li>
    
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle text-white" href="#" role="button" data-bs-toggle="dropdown">
          Others
        </a>
        <ul class="dropdown-menu">
          <li><a class="dropdown-item" href="#">üí¨Reviews</a></li>
          <li><a class="dropdown-item" href="#">üéÅOffers</a></li>
          <li><a class="dropdown-item" href="#">Romance</a></li>
          <li><a class="dropdown-item" href="#">Thriller</a></li>
          <li><a class="dropdown-item" href="#">Fantasy</a></li>
          <li><a class="dropdown-item" href="#">Self-Help</a></li>
        </ul>
      </li>
      
    </ul>
    </ul>

    <form class="d-flex flex-grow-1 ms-3" role="search">
      <input class="form-control me-2 w-100" type="search" placeholder="Search books" aria-label="Search">
      <button class="btn btn-outline-warning" type="submit">Search</button>
    </form>
    <ul class="navbar-nav ms-3 d-flex align-items-center gap-3">
      <!-- Wishlist Icon -->
      <li class="nav-item">
        <a class="nav-link icon-brown" href="#" title="Wishlist"><i class="fas fa-heart"></i></a>
      </li>
    
      <!-- Cart Icon -->
      <li class="nav-item">
        <a class="nav-link icon-brown" href="#" title="Cart"><i class="fas fa-shopping-cart"></i></a>
      </li>
    
      <!-- Profile Icon -->
      <li class="nav-item">
        <a href="profile.htm" title="Profile">
          <img
id="navProfilePic"
src="https://via.placeholder.com/40"
alt="Profile"
class="nav-profile-img"
onerror="this.src='profile-image.webp';"
/>
   </a>
      </li>
      
    </ul>
    

  
</li>
</ul>

  </div>
</nav>

  <button id="darkModeToggle" aria-label="Toggle Dark Mode" onclick="toggleDarkMode()">
    <span id="darkModeIcon">üåô</span>
  </button>

  <div class="container profile-container mt-4">
    <div class="profile-box text-center">
      <h4>üë§ Profile</h4>
      <img id="profilePicPreview" src="https://via.placeholder.com/120" alt="Profile Picture" class="profile-img mb-3" />
      <div class="view-section text-start">
        <p><strong>Full Name:</strong> <span id="displayFullName"></span></p>
        <p><strong>Username:</strong> <span id="displayUsername"></span></p>
        <p><strong>Email:</strong> <span id="displayEmail"></span></p>
        <p><strong>DOB:</strong> <span id="displayDob"></span></p>
        <p><strong>Location:</strong> <span id="displayLocation"></span></p>
      </div>
      <div class="edit-section">
        <input type="file" accept="image/*" class="form-control mb-2" id="profilePicInput" />
        <input type="text" id="editFullName" class="form-control mb-2" placeholder="Full Name" />
        <input type="text" id="editUsername" class="form-control mb-2" placeholder="Username" />
        <input type="email" id="editEmail" class="form-control mb-2" placeholder="Email" />
        <input type="date" id="editDob" class="form-control mb-2" />
        <input type="text" id="editLocation" class="form-control mb-2" placeholder="Location" />
      </div>
      <button class="btn btn-primary mt-2" onclick="toggleEdit()">Edit Profile</button>
      <button class="btn btn-danger mt-2" onclick="logout()">Logout</button>
    </div>

    <div class="content-box">
      <h4>üìö Reading Info</h4>
      <div class="view-section">
        <p><strong>Instagram:</strong> <span id="displayInsta"></span></p>
        <p><strong>Goodreads:</strong> <span id="displayGoodreads"></span></p>
        <p><strong>Favorite Genres:</strong> <span id="displayGenres"></span></p>
        <p><strong>Reading Goal:</strong> <span id="displayGoal"></span></p>
      </div>
      <div class="edit-section">
        <input type="text" id="editInsta" class="form-control mb-2" placeholder="Instagram ID" />
        <input type="text" id="editGoodreads" class="form-control mb-2" placeholder="Goodreads ID" />
        <input type="text" id="editGenres" class="form-control mb-2" placeholder="Favorite Genres" />
        <input type="text" id="editGoal" class="form-control mb-2" placeholder="Reading Goal" />
        <button class="btn btn-success mt-2" onclick="saveProfile()">Save Profile</button>
      </div>
    </div>
  </div>

  <script>
    let editing = false;
    let user = null;

    function toggleDarkMode() {
      const body = document.body;
      const icon = document.getElementById("darkModeIcon");
      body.classList.toggle("dark-mode");
      const isDark = body.classList.contains("dark-mode");
      localStorage.setItem("darkMode", isDark);
      icon.textContent = isDark ? "üåû" : "üåô";
    }

    function toggleEdit() {
      editing = !editing;
      document.querySelectorAll('.edit-section').forEach(el => el.style.display = editing ? 'block' : 'none');
      document.querySelectorAll('.view-section').forEach(el => el.style.display = editing ? 'none' : 'block');

      if (editing && user) {
        document.getElementById('editFullName').value = user.fullName || '';
        document.getElementById('editUsername').value = user.username || '';
        document.getElementById('editEmail').value = user.email;
        document.getElementById('editDob').value = user.dob || '';
        document.getElementById('editLocation').value = user.location || '';
        document.getElementById('editInsta').value = user.insta || '';
        document.getElementById('editGoodreads').value = user.goodreads || '';
        document.getElementById('editGenres').value = user.genres || '';
        document.getElementById('editGoal').value = user.goal || '';
      }
    }

    function saveProfile() {
      const imageFile = document.getElementById('profilePicInput').files[0];
      const reader = new FileReader();

      const updatedUser = {
        fullName: document.getElementById('editFullName').value,
        username: document.getElementById('editUsername').value,
        email: document.getElementById('editEmail').value,
        dob: document.getElementById('editDob').value,
        location: document.getElementById('editLocation').value,
        insta: document.getElementById('editInsta').value,
        goodreads: document.getElementById('editGoodreads').value,
        genres: document.getElementById('editGenres').value,
        goal: document.getElementById('editGoal').value,
        profilePic: user?.profilePic || "https://via.placeholder.com/120"
      };

      if (imageFile) {
        reader.onload = function (e) {
          updatedUser.profilePic = e.target.result;
          localStorage.setItem("readscape_user", JSON.stringify(updatedUser));
          loadProfile();
          toggleEdit();
          alert("Profile updated successfully!");
        };
        reader.readAsDataURL(imageFile);
      } else {
        localStorage.setItem("readscape_user", JSON.stringify(updatedUser));
        loadProfile();
        toggleEdit();
        alert("Profile updated successfully!");
      }
    }

    function loadProfile() {
      const userData = JSON.parse(localStorage.getItem("readscape_user"));
      if (!userData) {
        document.body.innerHTML = `<div class="container text-center mt-5">
            <h2>Oops!</h2>
            <p>No user is signed in. Please <a href="Booknew.htm">go back</a> and register or login.</p>
          </div>`;
        return;
      }

      user = userData;
      document.getElementById("displayFullName").textContent = userData.fullName || "Not set";
        document.getElementById("displayUsername").textContent = userData.username || "Not set";
      document.getElementById("displayEmail").textContent = userData.email;
      document.getElementById("displayDob").textContent = userData.dob || "Not set";
      document.getElementById("displayLocation").textContent = userData.location || "Not set";
      document.getElementById("displayInsta").textContent = userData.insta || "Not set";
      document.getElementById("displayGoodreads").textContent = userData.goodreads || "Not set";
      document.getElementById("displayGenres").textContent = userData.genres || "Not set";
      document.getElementById("displayGoal").textContent = userData.goal || "Not set";
      document.getElementById("profilePicPreview").src = userData.profilePic || "https://via.placeholder.com/120";
      const navPic = document.getElementById("navProfilePic");
  if (navPic) {
    navPic.src = userData.profilePic || "https://via.placeholder.com/40";
  }
    }

    function logout() {
      localStorage.removeItem("readscape_user");
      alert("You have been logged out.");
      window.location.href = "Booknew.htm";
    }

    window.onload = function () {
      loadProfile();
      const isDark = localStorage.getItem("darkMode") === "true";
      if (isDark) {
        document.body.classList.add("dark-mode");
        document.getElementById("darkModeIcon").textContent = "üåû";
      }
    };
  </script>
</body>
</html>
